[General]
network = project.SimpleNet
sim-time-limit = 100s

# Run simulation without asking for user input
cmdenv-interactive = false
cmdenv-express-mode = true
cmdenv-autoflush = true

# Default settings for all scenarios
**.vector-recording = false
**.scalar-recording = true

# ============ ASSIGN ALL MODULE ADDRESSES ============
# Sender side
**.sender.address = 100
**.mta_Client_S.address = 200
**.mta_Server_S.address = 300
**.spool.address = 400
**.dns1.address = 150

# Middle - encrypted communication path
**.mta_Client_SS.address = 500
**.sniffer.address = 550
**.mta_Server_RS.address = 600
**.dns.address = 650

# Receiver side
**.mailbox.address = 700
**.maa_Server.address = 800
**.maa_Client.address = 810
**.maa_Client.receiverAddr = 850
**.receiver.address = 850
**.receiver.dnsAddr = 860
**.dns2.address = 860
**.dns2.answerAddr = 810

# Certificate Authority (must match email.ned)
**.ca.address = 950

# ============ CONFIGURE ROUTER ROUTING TABLES ============
# Main router connects: sniffer(gate0), dns(gate1), mta_Server_RS(gate2), CA(gate3)
**.router.routes = "500:0, 650:1, 600:2, 950:3"

# ============ CONFIGURE SENDER EMAIL ============
**.sender.message = "Test email message"
**.sender.mail_from = "alice@sender.com"
**.sender.mail_to = "bob@receiver.com"
**.sender.mail_subject = "Test Email - Security Demonstration"
**.sender.mail_body = "This is a test email to demonstrate the Man-in-the-Middle attack and its prevention using certificates."

#==============================================================================
# SCENARIO 1: Man-in-the-Middle Attack (NO CERTIFICATES)
# This scenario demonstrates the vulnerability of key exchange without authentication
# The sniffer intercepts and substitutes keys successfully
#==============================================================================
[Config Scenario1_MITM_Attack]
description = "MITM Attack Succeeds "

# Disable certificate verification (default behavior)
**.useCertificates = false
**.ca.enabled = false

# Display settings
**.displayString = "b=,,rect"

#==============================================================================
# SCENARIO 2: Certificate-Based Protection (MITM PREVENTED)
# This scenario shows how certificates prevent MITM attacks
# The CA issues certificates, and parties verify them before key exchange
#==============================================================================
[Config Scenario2_With_Certificates]
description = "Certificate Verification Enabled"

# Enable certificate verification
**.useCertificates = true
**.ca.enabled = true

# Certificate validity period (in simulation seconds)
**.ca.certificateValidityPeriod = 3600s

# Display settings
**.displayString = "b=,,rect"
